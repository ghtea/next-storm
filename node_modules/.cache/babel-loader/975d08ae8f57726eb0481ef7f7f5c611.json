{"ast":null,"code":"import _regeneratorRuntime from\"/usr/projects/parallel-storm/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/usr/projects/parallel-storm/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/usr/projects/parallel-storm/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/usr/projects/parallel-storm/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/usr/projects/parallel-storm/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject21(){var data=_taggedTemplateLiteral([\"\\n  \\n  display: flex;\\n  flex-direction: row;\\n  justify-content: center;\\n  align-items: center;\\n  flex-wrap: wrap;\\n  \\n  & > div {\\n    width: auto;   // important!!!\\n    height: auto;\\n  }\\n  \\n  & > div > div {\\n    width: 20px;\\n    height: 20px;\\n    margin: 2px;\\n  }\\n\"]);_templateObject21=function _templateObject21(){return data;};return data;}function _templateObject20(){var data=_taggedTemplateLiteral([\"\\n  \\n  font-weight: \",\";\\n  \\n  width: auto;\\n  max-width: inherit;\\n  \\n  display: inline;\\n  text-algin: left;\\n  overflow: hidden;\\n  white-space: nowrap;\\n  text-overflow: ellipsis;\\n\"]);_templateObject20=function _templateObject20(){return data;};return data;}function _templateObject19(){var data=_taggedTemplateLiteral([\"\\n  justify-self: start;\\n  \\n  padding-left: 10px;\\n  \\n  display: flex;\\n  flex-direction: row;\\n  justify-content: flex-start;\\n  align-items: flex-end;\\n  \\n  cursor: pointer;\\n  \\n  @media (max-width: \",\"px ) {\\n    display: flex;\\n    flex-direction: column;\\n    justify-content: center;\\n    align-items: flex-start;\\n  }\\n\"]);_templateObject19=function _templateObject19(){return data;};return data;}function _templateObject18(){var data=_taggedTemplateLiteral([\"\\n  padding-left: 10px;\\n  \\n  display: block;\\n  text-algin: left;\\n\"]);_templateObject18=function _templateObject18(){return data;};return data;}function _templateObject17(){var data=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-template-columns:   100px 120px;\\n  grid-template-rows: 40px;\\n\\n  \\n  \\n  border-bottom: 1px solid \",\";\\n  &:last-child {\\n    border-bottom-style: none;\\n  }\\n\"]);_templateObject17=function _templateObject17(){return data;};return data;}function _templateObject16(){var data=_taggedTemplateLiteral([\"\\n  width: 60px;\\n\"]);_templateObject16=function _templateObject16(){return data;};return data;}function _templateObject15(){var data=_taggedTemplateLiteral([\"\\n  width: 100px;\\n  font-size: 0.9rem;\\n  color: \",\";\\n\"]);_templateObject15=function _templateObject15(){return data;};return data;}function _templateObject14(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: center;\\n  align-items: center;\\n\"]);_templateObject14=function _templateObject14(){return data;};return data;}function _templateObject13(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  align-items: center;\\n\"]);_templateObject13=function _templateObject13(){return data;};return data;}function _templateObject12(){var data=_taggedTemplateLiteral([\"\\n  font-size: 1.2rem;\\n\"]);_templateObject12=function _templateObject12(){return data;};return data;}function _templateObject11(){var data=_taggedTemplateLiteral([\"\\n  \\n  width: 220px;\\n  margin:5px;\\n  \\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  align-items: center;\\n\"]);_templateObject11=function _templateObject11(){return data;};return data;}function _templateObject10(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: center;\\n  align-items: flex-start;\\n  \\n  flex-wrap: wrap;\\n  \\n  @media (max-width: \",\"px ) {\\n    overflow-y: auto;\\n    height: 360px;\\n  }\\n\"]);_templateObject10=function _templateObject10(){return data;};return data;}function _templateObject9(){var data=_taggedTemplateLiteral([\"\\n  color: \",\";\\n  width:auto;\\n  height: 30px;\\n  border-radius: 6px;\\n  margin-left: 3px;\\n  margin-right: 3px;\\n\"]);_templateObject9=function _templateObject9(){return data;};return data;}function _templateObject8(){var data=_taggedTemplateLiteral([\"\\n  \\n  width: 90%; \\n  display: flex;\\n  flex-direction: row;\\n  justify-content: center;\\n  align-items: center;\\n  \\n  overflow-x: auto;\\n  width: 100%;\\n \\n\"]);_templateObject8=function _templateObject8(){return data;};return data;}function _templateObject7(){var data=_taggedTemplateLiteral([\"\\n  width: 90px;\\n  height: 36px;\\n  \\n  margin-left: 5px;\\n  margin-right: 5px;\\n  \\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-evenly;\\n  align-items: center;\\n  \\n  border-radius: 10px;\\n  \\n  \\n  & > div {\\n    height: 100%;\\n  }\\n\"]);_templateObject7=function _templateObject7(){return data;};return data;}function _templateObject6(){var data=_taggedTemplateLiteral([\"\\n  width: 90px;\\n  height: 36px;\\n  \\n  margin-left: 5px;\\n  margin-right: 5px;\\n  \\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-evenly;\\n  align-items: center;\\n  \\n  border-radius: 10px;\\n  \\n  \\n  & > div {\\n    height: 100%;\\n  }\\n\"]);_templateObject6=function _templateObject6(){return data;};return data;}function _templateObject5(){var data=_taggedTemplateLiteral([\"\\n\\twidth: 150px;\\n\\theight: 36px;\\n\\t\\n\\tborder-radius: 10px;\\n\\t\\n\\tmargin-top: 3px;\\n  margin-bottom: 3px;\\n  \\n\\tmargin-left: 5px;\\n  margin-right: 5px;\\n\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  width: 180px;\\n  height: 36px;\\n  \\n  \\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-evenly;\\n  align-items: center;\\n  \\n  border-radius: 10px;\\n  \\n  & > div {\\n    \\n    height: 100%;\\n  }\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  margin-top: 3px;\\n  margin-bottom: 3px;\\n  \\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  align-items: center;\\n  \\n  & > div {\\n    display: flex;\\n    flex-direction: row;\\n    justify-content: center;\\n    align-items: center;\\n    \\n    margin-top: 5px;\\n    margin-bottom: 5px;\\n  }\\n  \\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  margin-top: 20px;\\n  \\n  font-size: 1.2rem;\\n  font-weight: bold;\\n  \\n  margin-bottom: 10px;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  max-width: 600px;\\n  \\n  display: flex;\\n  flex-direction: column;\\n  justify-content: flex-start;\\n  align-items: center;\\n  \\n  padding-bottom: 10px;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import dotenv from'dotenv';import React,{useState,useEffect}from'react';import useInput from'../../tools/hooks/useInput';import styled from'styled-components';import axios from'axios';import{NavLink,useParams}from'react-router-dom';import{connect}from\"react-redux\";import{addResult as _addResult,deleteResult as _deleteResult}from\"../../redux/store\";import readPlanTeam from\"../../redux/thunks/readPlanTeam\";import _addRemoveNotification from\"../../redux/thunks/addRemoveNotification\";// https://reacttraining.com/blog/react-router-v5-1/\nimport{Div,Button,Input}from'../../styles/DefaultStyles';import IconConfirmed from'../../svgs/IconConfirmed';import IconPending from'../../svgs/IconPending';import IconInfo from'../../svgs/IconInfo';import IconMagic from'../../svgs/basic/IconMagic';import IconUpload from'../../svgs/basic/IconUpload';import IconDelete from'../../svgs/basic/IconDelete';import IconTank from'../../svgs/roles/IconTank';import IconBruiser from'../../svgs/roles/IconBruiser';import IconMeleeAssassin from'../../svgs/roles/IconMeleeAssassin';import IconRangedAssassin from'../../svgs/roles/IconRangedAssassin';import IconHealer from'../../svgs/roles/IconHealer';import{CopyToClipboard}from'react-copy-to-clipboard';import{getRandomSubArray}from'../../tools/vanilla/array';var DivResult=styled(Div)(_templateObject());var DivResultTitle=styled(Div)(_templateObject2());var GroupButtonMain=styled(Div)(_templateObject3());var ButtonGenerate=styled(Button)(_templateObject4());var InputTitleResult=styled(Input)(_templateObject5());var ButtonSave=styled(Button)(_templateObject6());var ButtonDelete=styled(Button)(_templateObject7());var ListTitleResult=styled(Div)(_templateObject8());var ButtonChooseResult=styled(Button)(_templateObject9(),function(props){return props.isActive?props.theme.color_active:props.theme.color_normal;});var DivAllTeams=styled(Div)(_templateObject10(),function(props){return props.theme.media.mid_big-1;});// each TableTeam\nvar DivTableTeam=styled(Div)(_templateObject11());var DivNameEachTeam=styled(Div)(_templateObject12());var DivRosterEachTeam=styled(Div)(_templateObject13());var DivAverageMmrEachTeam=styled(Div)(_templateObject14());var DivAverageMmrEachTeamText=styled(Div)(_templateObject15(),function(props){return props.theme.color_weak;});var DivAverageMmrEachTeamValue=styled(Div)(_templateObject16());// each row\nvar DivRowPlayer=styled(Div)(_templateObject17(),function(props){return props.theme.color_very_weak;});var DivBattletagHeader=styled(Div)(_templateObject18());var DivBattletag=styled(Div)(_templateObject19(),function(props){return props.theme.media.small_mid-1;});var DivBattletagName=styled(Div)(_templateObject20(),function(props){return props.isLeader?\"bold\":\"regular\";});var DivRoles=styled(Div)(_templateObject21());var RowPlayer=function RowPlayer(_ref){var battletag=_ref.battletag,roles=_ref.roles,isLeader=_ref.isLeader,addRemoveNotification=_ref.addRemoveNotification;var regexBattletag=/(#\\d*)$/;var listNumberBattletag=battletag.match(regexBattletag);var battletagNumber=listNumberBattletag[0];var battletagName=battletag.replace(regexBattletag,\"\");return/*#__PURE__*/React.createElement(DivRowPlayer,null,/*#__PURE__*/React.createElement(CopyToClipboard,{text:battletag,onCopy:function onCopy(){addRemoveNotification(\"success\",\"'\".concat(battletag,\"' has been copied\"));}},/*#__PURE__*/React.createElement(DivBattletag,null,/*#__PURE__*/React.createElement(DivBattletagName,{isLeader:isLeader},\" \",battletagName,\" \"))),/*#__PURE__*/React.createElement(DivRoles,null,/*#__PURE__*/React.createElement(Div,null,\" \",roles.includes(\"Tank\")?/*#__PURE__*/React.createElement(IconTank,{width:\"20px\",height:\"20px\"}):/*#__PURE__*/React.createElement(Div,null),\" \"),/*#__PURE__*/React.createElement(Div,null,\" \",roles.includes(\"Bruiser\")?/*#__PURE__*/React.createElement(IconBruiser,{width:\"20px\",height:\"20px\"}):/*#__PURE__*/React.createElement(Div,null),\" \"),/*#__PURE__*/React.createElement(Div,null,\" \",roles.includes(\"Melee Assassin\")?/*#__PURE__*/React.createElement(IconMeleeAssassin,{width:\"18px\",height:\"20px\"}):/*#__PURE__*/React.createElement(Div,null),\" \"),/*#__PURE__*/React.createElement(Div,null,\" \",roles.includes(\"Ranged Assassin\")?/*#__PURE__*/React.createElement(IconRangedAssassin,{width:\"20px\",height:\"20px\"}):/*#__PURE__*/React.createElement(Div,null),\" \"),/*#__PURE__*/React.createElement(Div,null,\" \",roles.includes(\"Healer\")?/*#__PURE__*/React.createElement(IconHealer,{width:\"15px\",height:\"20px\"}):/*#__PURE__*/React.createElement(Div,null),\" \")));};var TableTeam=function TableTeam(_ref2){var objTeam=_ref2.objTeam,listPlayerEntry=_ref2.listPlayerEntry,addRemoveNotification=_ref2.addRemoveNotification,region=_ref2.region;var listPlayerBattletag=objTeam.listPlayerBattletag;//  정렬 함수\nvar sortListBattletagByMmrHigherFirst=function sortListBattletagByMmrHigherFirst(battletag1,battletag2){// mmr 높은순으로 list of battletags\nvar objPlayer1=listPlayerEntry.find(function(objPlayer){return objPlayer._id===battletag1;});var objPlayer2=listPlayerEntry.find(function(objPlayer){return objPlayer._id===battletag2;});if(objPlayer1.tags.includes(\"leader\")){return-1;}// leader 는 무조건 앞에\nelse if(objPlayer2.tags.includes(\"leader\")){return 1;}// leader 는 무조건 앞에\nelse{return objPlayer2.mmr.standard[region]-objPlayer1.mmr.standard[region];// ex 3333, 222, 1111\n}};// 평균 mmr 계산\nvar sumOfMmmr=0;var _loop=function _loop(iMember){var cBattletag=listPlayerBattletag[iMember];var cObjPlayer=listPlayerEntry.find(function(objPlayer){return objPlayer._id===cBattletag;});sumOfMmmr+=cObjPlayer.mmr.standard[region];};for(var iMember=0;iMember<5;iMember++){_loop(iMember);}var averageOfMmr=Math.floor(sumOfMmmr/5);var listPlayerBattletagSorted=listPlayerBattletag.sort(function(battletag1,battletag2){return sortListBattletagByMmrHigherFirst(battletag1,battletag2);});return/*#__PURE__*/React.createElement(DivTableTeam,null,/*#__PURE__*/React.createElement(DivNameEachTeam,null,\" \",objTeam.name,\" \"),/*#__PURE__*/React.createElement(DivRosterEachTeam,null,listPlayerBattletagSorted.map(function(battletag,i){var cObjPlayer=listPlayerEntry.find(function(objPlayer){return objPlayer._id===battletag;});var isLeader=cObjPlayer.tags.includes(\"leader\");return/*#__PURE__*/React.createElement(RowPlayer,{key:battletag,battletag:battletag,roles:cObjPlayer.roles,isLeader:isLeader,addRemoveNotification:addRemoveNotification});})// inside map\n),/*#__PURE__*/React.createElement(DivAverageMmrEachTeam,null,/*#__PURE__*/React.createElement(DivAverageMmrEachTeamText,null,\" average mmr: \"),/*#__PURE__*/React.createElement(DivAverageMmrEachTeamValue,null,\" \",averageOfMmr,\" \")));// return\n};/* \r\n\r\n*/var Result=function Result(_ref3){var authority=_ref3.authority,idPlanTeam=_ref3.idPlanTeam,option=_ref3.option,listPlayerEntry=_ref3.listPlayerEntry,listResult=_ref3.listResult,addRemoveNotification=_ref3.addRemoveNotification,addResult=_ref3.addResult,deleteResult=_ref3.deleteResult;var inputTitleResult=useInput(\"\");var _useState=useState([]),_useState2=_slicedToArray(_useState,2),listTeamLocal=_useState2[0],setListTeamLocal=_useState2[1];var _useState3=useState({listTeam:[]}),_useState4=_slicedToArray(_useState3,2),resultShowing=_useState4[0],setResultShowing=_useState4[1];var region=option.region;var numberTeamsPlanned=option.numberTeams;var listPlayerBattletag=Object.keys(listPlayerEntry).map(function(element){return listPlayerEntry[element]._id;});// list of battletags, this can be modified by .sort\n// 1. confirmed - 2. leader - 3. less roles player(2, 1) - 4. rest\nvar onClick_generateTeams=function onClick_generateTeams(event){var numberTeamsResult;var listBattletagPlaying=[];var listBattletagPlayingSorted=[];//  많이 쓸 정렬 함수\nvar sortListBattletagByMmrHigherFirst=function sortListBattletagByMmrHigherFirst(battletag1,battletag2){// mmr 높은순으로 list of battletags\nvar objPlayer1=listPlayerEntry.find(function(objPlayer){return objPlayer._id===battletag1;});var objPlayer2=listPlayerEntry.find(function(objPlayer){return objPlayer._id===battletag2;});return objPlayer2.mmr.standard[region]-objPlayer1.mmr.standard[region];// ex 3333, 222, 1111\n};// A. 먼저 leader, confirmed  인 것들 고려해서 총 플레이 인원 뽑기\n// B. 그다음 총 리스트를 leader, 플레이 역할 적은 플레이어, 그외 로 세 개로 나누고, 각각의 3개의 리스트 안에서 mmr 높은 순으로 정렬하고 합치기\n// C. 정렬된 플레이러들을, (example of 3 teams)\n// team:  0 1 2    2 1 0   0 1 2    2 1 0  마지막 주기는  mmr 총합 낮은 팀에 mmr 높은 사람 넣는 식으로!\n// A-1\nvar listBattletagConfirmed=listPlayerBattletag.filter(function(battletag){var objPlayer=listPlayerEntry.find(function(objPlayer){return objPlayer._id===battletag;});return objPlayer.status===\"confirmed\";});var listBattletagConfirmedLeader=listBattletagConfirmed.filter(function(battletag){var objPlayer=listPlayerEntry.find(function(objPlayer){return objPlayer._id===battletag;});return objPlayer.tags.includes(\"leader\");});var listBattletagConfirmedNonLeader=listBattletagConfirmed.filter(function(battletag){var objPlayer=listPlayerEntry.find(function(objPlayer){return objPlayer._id===battletag;});return!objPlayer.tags.includes(\"leader\");});//  먼저 설정된 팀 개수 검토\n// numberTeamsPlanned: 0  means auto \nif(numberTeamsPlanned===0){numberTeamsResult=Math.floor(listBattletagConfirmed.length/5);}else if(listBattletagConfirmed.length<numberTeamsPlanned*5){addRemoveNotification(\"error\",\"the number of team which you have set was adjusted\");numberTeamsResult=Math.floor(listBattletagConfirmed.length/5);}else{numberTeamsResult=numberTeamsPlanned;}// A-2\nif(numberTeamsResult===0){addRemoveNotification(\"error\",\"need at least 5 confirmed players\");}else if(listBattletagConfirmedLeader.length>=numberTeamsResult*5){listBattletagPlaying=getRandomSubArray(listBattletagConfirmedLeader,numberTeamsPlanned*5);}else{var numberConfirmedLeader=listBattletagConfirmedLeader.length;var listBattletagConfirmedNonLeaderPlaying=getRandomSubArray(listBattletagConfirmedNonLeader,numberTeamsResult*5-numberConfirmedLeader);listBattletagPlaying=[].concat(_toConsumableArray(listBattletagConfirmedLeader),_toConsumableArray(listBattletagConfirmedNonLeaderPlaying));}//console.log(\"listBattletagPlaying\")\n//console.log(listBattletagPlaying)\n// B. 그다음 총 리스트를 leader, 플레이 역할 적은 플레이어, 그외 로 세 개로 나누고, 각각의 3개의 리스트 안에서 mmr 높은 순으로 정렬하고 합치기\nvar listBattletagPlayingLeader=listBattletagPlaying.filter(function(battletag){var objPlayer=listPlayerEntry.find(function(objPlayer){return objPlayer._id===battletag;});return objPlayer.tags.includes(\"leader\");});listBattletagPlayingLeader=listBattletagPlayingLeader.sort(function(battletag1,battletag2){return sortListBattletagByMmrHigherFirst(battletag1,battletag2);});var listBattletagPlayingLessRoles=listBattletagPlaying.filter(function(battletag){var objPlayer=listPlayerEntry.find(function(objPlayer){return objPlayer._id===battletag;});return!objPlayer.tags.includes(\"leader\")&&objPlayer.roles.length<=2;});listBattletagPlayingLessRoles=listBattletagPlayingLessRoles.sort(function(battletag1,battletag2){return sortListBattletagByMmrHigherFirst(battletag1,battletag2);});var listBattletagPlayingTheOthers=listBattletagPlaying.filter(function(battletag){var objPlayer=listPlayerEntry.find(function(objPlayer){return objPlayer._id===battletag;});return!(objPlayer.roles.length<=2)&&!objPlayer.tags.includes(\"leader\");});listBattletagPlayingTheOthers=listBattletagPlayingTheOthers.sort(function(battletag1,battletag2){return sortListBattletagByMmrHigherFirst(battletag1,battletag2);});// finally\nlistBattletagPlayingSorted=[].concat(_toConsumableArray(listBattletagPlayingLeader),_toConsumableArray(listBattletagPlayingLessRoles),_toConsumableArray(listBattletagPlayingTheOthers));console.log(\"listBattletagPlayingSorted\");console.log(listBattletagPlayingSorted);// C. 정렬된 플레이러들을, (example of 3 teams)\n// team:  0 1 2    2 1 0   0 1 2    2 1 0  마지막 주기는  mmr 총합 낮은 팀에 mmr 높은 사람 넣는 식으로!\n//https://stackoverflow.com/questions/3746725/how-to-create-an-array-containing-1-n\nvar listIndexTeam=[];var listIncreasing=Array.from(Array(numberTeamsResult),function(_,i){return i;});// => [0, 1, 2, 3, 4, 5, ...]\nvar listDecreasing=Array.from(Array(numberTeamsResult),function(_,i){return numberTeamsResult-1-i;});// => [5, 4, 3, ... ]\nlistIndexTeam=[].concat(_toConsumableArray(listIncreasing),_toConsumableArray(listDecreasing),_toConsumableArray(listIncreasing),_toConsumableArray(listDecreasing));//console.log('listIndexTeam')\n//console.log(listIndexTeam)\nvar listTeamTemp=new Array(numberTeamsResult);for(var i=0;i<numberTeamsResult;i++){listTeamTemp[i]={};listTeamTemp[i]['name']=\"TEAM \".concat(i+1);listTeamTemp[i]['listPlayerBattletag']=[];}for(var iBattletag=0;iBattletag<listBattletagPlayingSorted.length-numberTeamsResult;iBattletag++){var cBattletag=listBattletagPlayingSorted[iBattletag];var indexTeamToPush=listIndexTeam[iBattletag];listTeamTemp[indexTeamToPush]['listPlayerBattletag'].push(cBattletag);}console.log(\"listTeamTemp\");console.log(listTeamTemp);var listTeamSumOfMmr=Array.from(Array(numberTeamsResult),function(_,i){return 0;});// numberTeamsResult 개의  0 으로 이루어진 리스트\nvar listTeamAverageOfMmr=Array.from(Array(numberTeamsResult),function(_,i){return 0;});// numberTeamsResult 개의  0 으로 이루어진 리스트\n//console.log(listTeamSumOfMmr);\nfor(var iTeam=0;iTeam<numberTeamsResult;iTeam++){var _loop2=function _loop2(iMember){var cBattletag=listTeamTemp[iTeam]['listPlayerBattletag'][iMember];var cObjPlayer=listPlayerEntry.find(function(objPlayer){return objPlayer._id===cBattletag;});listTeamSumOfMmr[iTeam]+=cObjPlayer.mmr.standard[region];};for(var iMember=0;iMember<4;iMember++){_loop2(iMember);}}console.log(\"listTeamSumOfMmr\");console.log(listTeamSumOfMmr);var listIndexTeamWhichNeedHighMmrPlayer=[];var listTool=Array.from(Array(numberTeamsResult),function(_,i){return i;});// [0, 1, 2, ...]\nlistIndexTeamWhichNeedHighMmrPlayer=listTool.sort(function(index1,index2){var SumOfMmmr1=listTeamSumOfMmr[index1];var SumOfMmmr2=listTeamSumOfMmr[index2];return SumOfMmmr1-SumOfMmmr2;// 작은게 앞에 나오게 된다.\n});// 마지막 인원들 넣기\nvar _loop3=function _loop3(jTeam){var cIndexTeam=listIndexTeamWhichNeedHighMmrPlayer[jTeam];var cBattletag=listBattletagPlayingSorted[numberTeamsResult*4+jTeam];var cObjPlayer=listPlayerEntry.find(function(objPlayer){return objPlayer._id===cBattletag;});listTeamTemp[cIndexTeam]['listPlayerBattletag'].push(cBattletag);listTeamSumOfMmr[cIndexTeam]+=cObjPlayer.mmr.standard[region];};for(var jTeam=0;jTeam<numberTeamsResult;jTeam++){_loop3(jTeam);}// calculate mmr average\nfor(var _iTeam=0;_iTeam<numberTeamsResult;_iTeam++){listTeamAverageOfMmr[_iTeam]=listTeamSumOfMmr[_iTeam]/5;}console.log(listTeamTemp);console.log(\"final average of mmr each team: \");console.log(listTeamAverageOfMmr);setListTeamLocal(listTeamTemp);var newResult={title:\"local\",_id:\"local\",added:Date.now(),listTeam:listTeamTemp};// 이미 list에 있는 _id = \"local\" 인걸 없애야 한다\naddResult(newResult);//  표시\nsetResultShowing(newResult);};//onClick_generateTeams\n/*\r\nconst inputTitleResult = useInput(\"\");\r\n\r\nconst [listTeams, setListTeams] = useState([]);\r\n\r\nconst region = option.region;\r\nconst numberTeamsPlanned = option.numberTeams;\r\nconst listPlayerBattletag = (Object.keys(listPlayerEntry)).map(element=>listPlayerEntry[element]._id); // list of battletags, this can be modified by .sort\r\n\r\n*/ // 1\nvar onClick_SaveResult=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var titleResult,now,date,hour,min,newResult;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(listTeamLocal.length>0)){_context.next=15;break;}_context.prev=1;if(inputTitleResult.value){titleResult=inputTitleResult.value;}else{now=new Date();date=now.getDate();hour=now.getHours();min=now.getMinutes();titleResult=\"\".concat(date,\"_\").concat(hour,\":\").concat(min);}newResult={title:titleResult,_id:Date.now().toString(),added:Date.now(),listTeam:listTeamLocal};addResult(newResult);//replaceRegion(newRegion);\n_context.next=7;return axios.put(\"\".concat(process.env.REACT_APP_URL_AHR,\"/plan-team/\"),{filter:{_id:idPlanTeam},update:{$push:{\"listResult\":newResult}}});case 7:addRemoveNotification(\"success\",\"result has been saved!\");_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);addRemoveNotification(\"error\",\"failed in saving result\");case 13:_context.next=16;break;case 15:addRemoveNotification(\"error\",\"there is no result yet\");case 16:case\"end\":return _context.stop();}}},_callee,null,[[1,10]]);}));return function onClick_SaveResult(_x){return _ref4.apply(this,arguments);};}();var onClick_DeleteResult=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(resultShowing._id&&resultShowing._id===\"local\")){_context2.next=4;break;}addRemoveNotification(\"error\",\"just generate another result\");_context2.next=18;break;case 4:if(!resultShowing.listTeam.length){_context2.next=17;break;}_context2.prev=5;deleteResult(resultShowing._id);//replaceRegion(newRegion);\n_context2.next=9;return axios.put(\"\".concat(process.env.REACT_APP_URL_AHR,\"/plan-team/\"),{filter:{_id:idPlanTeam},update:{$pull:{\"listResult\":{\"_id\":resultShowing._id}}}});case 9:addRemoveNotification(\"success\",\"result has been deleted!\");_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](5);addRemoveNotification(\"error\",\"failed in deleting result\");case 15:_context2.next=18;break;case 17:addRemoveNotification(\"error\",\"plese click result first\");case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[5,12]]);}));return function onClick_DeleteResult(_x2){return _ref5.apply(this,arguments);};}();var onClick_ChooseResult=function onClick_ChooseResult(event,idChosen){var resultChosen=listResult.find(function(element){return element._id===idChosen;});setResultShowing(resultChosen);console.log(resultChosen);};return/*#__PURE__*/React.createElement(DivResult,null,/*#__PURE__*/React.createElement(DivResultTitle,null,\" Result \"),authority===\"administrator\"?/*#__PURE__*/React.createElement(GroupButtonMain,null,/*#__PURE__*/React.createElement(Div,null,/*#__PURE__*/React.createElement(ButtonGenerate,{onClick:onClick_generateTeams},/*#__PURE__*/React.createElement(Div,null,\" Generate Teams \"),/*#__PURE__*/React.createElement(IconMagic,{width:\"28px\",height:\"28px\"}))),/*#__PURE__*/React.createElement(Div,null,/*#__PURE__*/React.createElement(InputTitleResult,Object.assign({},inputTitleResult,{placeholder:\"title of result\"})),/*#__PURE__*/React.createElement(ButtonSave,{onClick:onClick_SaveResult},/*#__PURE__*/React.createElement(Div,null,\" Save \"),/*#__PURE__*/React.createElement(IconUpload,{width:\"40px\",height:\"32px\"})),/*#__PURE__*/React.createElement(ButtonDelete,{onClick:onClick_DeleteResult},/*#__PURE__*/React.createElement(Div,null,\" Delete \"),/*#__PURE__*/React.createElement(IconDelete,{width:\"28px\",height:\"32px\"})))):/*#__PURE__*/React.createElement(Div,null,\" \"),/*#__PURE__*/React.createElement(ListTitleResult,null,listResult.map(function(element){return/*#__PURE__*/React.createElement(ButtonChooseResult,{isActive:element._id===resultShowing._id,key:element._id,onClick:function onClick(event){return onClick_ChooseResult(event,element._id);}},\" \",element.title,\" \");})),/*#__PURE__*/React.createElement(DivAllTeams,null,resultShowing.listTeam.length?resultShowing.listTeam.map(function(team,index){return/*#__PURE__*/React.createElement(TableTeam,{key:team.name,objTeam:team,listPlayerEntry:listPlayerEntry,addRemoveNotification:addRemoveNotification,region:region});}):\"choose or generate result\"));};function mapStateToProps(state){return{authority:state.authority,idPlanTeam:state.planTeam._id,option:state.planTeam.option,listPlayerEntry:state.planTeam.listPlayerEntry,listResult:state.planTeam.listResult//listPlayerEntry: [...state.planTeam.listPlayerEntry]\n//,workingAddPlayerToListPlayerEntry: state.working.addPlayerToListPlayerEntry\n//,readyPlanTeam: state.ready.planTeam\n//,loading: state.loading\n};}function mapDispatchToProps(dispatch){return{addResult:function addResult(resultTeam){return dispatch(_addResult(resultTeam));},deleteResult:function deleteResult(idResult){return dispatch(_deleteResult(idResult));},addRemoveNotification:function addRemoveNotification(situation,message,time){return dispatch(_addRemoveNotification(situation,message,time));}};}// TableEntry 컴포넌트에서 redux의 state, dispatch 를 일부분 골라서 이용가능하게 된다\nexport default connect(mapStateToProps,mapDispatchToProps)(Result);","map":{"version":3,"sources":["/usr/projects/parallel-storm/src/components/TeamGenerator/Result.js"],"names":["dotenv","React","useState","useEffect","useInput","styled","axios","NavLink","useParams","connect","addResult","deleteResult","readPlanTeam","addRemoveNotification","Div","Button","Input","IconConfirmed","IconPending","IconInfo","IconMagic","IconUpload","IconDelete","IconTank","IconBruiser","IconMeleeAssassin","IconRangedAssassin","IconHealer","CopyToClipboard","getRandomSubArray","DivResult","DivResultTitle","GroupButtonMain","ButtonGenerate","InputTitleResult","ButtonSave","ButtonDelete","ListTitleResult","ButtonChooseResult","props","isActive","theme","color_active","color_normal","DivAllTeams","media","mid_big","DivTableTeam","DivNameEachTeam","DivRosterEachTeam","DivAverageMmrEachTeam","DivAverageMmrEachTeamText","color_weak","DivAverageMmrEachTeamValue","DivRowPlayer","color_very_weak","DivBattletagHeader","DivBattletag","small_mid","DivBattletagName","isLeader","DivRoles","RowPlayer","battletag","roles","regexBattletag","listNumberBattletag","match","battletagNumber","battletagName","replace","includes","TableTeam","objTeam","listPlayerEntry","region","listPlayerBattletag","sortListBattletagByMmrHigherFirst","battletag1","battletag2","objPlayer1","find","objPlayer","_id","objPlayer2","tags","mmr","standard","sumOfMmmr","iMember","cBattletag","cObjPlayer","averageOfMmr","Math","floor","listPlayerBattletagSorted","sort","name","map","i","Result","authority","idPlanTeam","option","listResult","inputTitleResult","listTeamLocal","setListTeamLocal","listTeam","resultShowing","setResultShowing","numberTeamsPlanned","numberTeams","Object","keys","element","onClick_generateTeams","event","numberTeamsResult","listBattletagPlaying","listBattletagPlayingSorted","listBattletagConfirmed","filter","status","listBattletagConfirmedLeader","listBattletagConfirmedNonLeader","length","numberConfirmedLeader","listBattletagConfirmedNonLeaderPlaying","listBattletagPlayingLeader","listBattletagPlayingLessRoles","listBattletagPlayingTheOthers","console","log","listIndexTeam","listIncreasing","Array","from","_","listDecreasing","listTeamTemp","iBattletag","indexTeamToPush","push","listTeamSumOfMmr","listTeamAverageOfMmr","iTeam","listIndexTeamWhichNeedHighMmrPlayer","listTool","index1","index2","SumOfMmmr1","SumOfMmmr2","jTeam","cIndexTeam","newResult","title","added","Date","now","onClick_SaveResult","value","titleResult","date","getDate","hour","getHours","min","getMinutes","toString","put","process","env","REACT_APP_URL_AHR","update","$push","onClick_DeleteResult","$pull","onClick_ChooseResult","idChosen","resultChosen","team","index","mapStateToProps","state","planTeam","mapDispatchToProps","dispatch","resultTeam","idResult","situation","message","time"],"mappings":"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","sourcesContent":["import dotenv from 'dotenv';\r\nimport React, {useState, useEffect} from 'react';\r\nimport useInput from '../../tools/hooks/useInput';\r\n\r\nimport styled from 'styled-components';\r\nimport axios from 'axios';\r\nimport { NavLink, useParams } from 'react-router-dom';\r\n\r\nimport { connect } from \"react-redux\";\r\n\r\nimport {addResult, deleteResult} from \"../../redux/store\";\r\nimport readPlanTeam from \"../../redux/thunks/readPlanTeam\";\r\nimport addRemoveNotification from \"../../redux/thunks/addRemoveNotification\";\r\n// https://reacttraining.com/blog/react-router-v5-1/\r\n\r\nimport {Div, Button, Input} from '../../styles/DefaultStyles';\r\n\r\n\r\nimport IconConfirmed from '../../svgs/IconConfirmed'\r\nimport IconPending from '../../svgs/IconPending'\r\nimport IconInfo from '../../svgs/IconInfo'\r\nimport IconMagic from  '../../svgs/basic/IconMagic'\r\nimport IconUpload from  '../../svgs/basic/IconUpload'\r\nimport IconDelete from  '../../svgs/basic/IconDelete'\r\n\r\n\r\nimport IconTank from '../../svgs/roles/IconTank'\r\nimport IconBruiser from '../../svgs/roles/IconBruiser'\r\nimport IconMeleeAssassin from '../../svgs/roles/IconMeleeAssassin'\r\nimport IconRangedAssassin from '../../svgs/roles/IconRangedAssassin'\r\nimport IconHealer from '../../svgs/roles/IconHealer'\r\n\r\nimport {CopyToClipboard} from 'react-copy-to-clipboard';\r\n\r\nimport {getRandomSubArray} from  '../../tools/vanilla/array'\r\n\r\n\r\nconst DivResult = styled(Div)`\r\n  width: 100%;\r\n  height: 100%;\r\n  max-width: 600px;\r\n  \r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n  \r\n  padding-bottom: 10px;\r\n`;\r\n\r\nconst DivResultTitle = styled(Div)`\r\n  margin-top: 20px;\r\n  \r\n  font-size: 1.2rem;\r\n  font-weight: bold;\r\n  \r\n  margin-bottom: 10px;\r\n`\r\n\r\nconst GroupButtonMain = styled(Div)`\r\n  margin-top: 3px;\r\n  margin-bottom: 3px;\r\n  \r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  \r\n  & > div {\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: center;\r\n    align-items: center;\r\n    \r\n    margin-top: 5px;\r\n    margin-bottom: 5px;\r\n  }\r\n  \r\n`\r\n\r\nconst ButtonGenerate = styled(Button)`\r\n  width: 180px;\r\n  height: 36px;\r\n  \r\n  \r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-evenly;\r\n  align-items: center;\r\n  \r\n  border-radius: 10px;\r\n  \r\n  & > div {\r\n    \r\n    height: 100%;\r\n  }\r\n`\r\n\r\nconst InputTitleResult = styled(Input)`\r\n\twidth: 150px;\r\n\theight: 36px;\r\n\t\r\n\tborder-radius: 10px;\r\n\t\r\n\tmargin-top: 3px;\r\n  margin-bottom: 3px;\r\n  \r\n\tmargin-left: 5px;\r\n  margin-right: 5px;\r\n`\r\n\r\n\r\nconst ButtonSave = styled(Button)`\r\n  width: 90px;\r\n  height: 36px;\r\n  \r\n  margin-left: 5px;\r\n  margin-right: 5px;\r\n  \r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-evenly;\r\n  align-items: center;\r\n  \r\n  border-radius: 10px;\r\n  \r\n  \r\n  & > div {\r\n    height: 100%;\r\n  }\r\n`\r\n\r\nconst ButtonDelete = styled(Button)`\r\n  width: 90px;\r\n  height: 36px;\r\n  \r\n  margin-left: 5px;\r\n  margin-right: 5px;\r\n  \r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-evenly;\r\n  align-items: center;\r\n  \r\n  border-radius: 10px;\r\n  \r\n  \r\n  & > div {\r\n    height: 100%;\r\n  }\r\n`\r\n\r\nconst ListTitleResult = styled(Div)`\r\n  \r\n  width: 90%; \r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: center;\r\n  align-items: center;\r\n  \r\n  overflow-x: auto;\r\n  width: 100%;\r\n \r\n`\r\n\r\nconst ButtonChooseResult = styled(Button)`\r\n  color: ${props => (props.isActive)?props.theme.color_active:props.theme.color_normal };\r\n  width:auto;\r\n  height: 30px;\r\n  border-radius: 6px;\r\n  margin-left: 3px;\r\n  margin-right: 3px;\r\n`\r\n\r\n\r\n\r\nconst DivAllTeams = styled(Div)`\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: center;\r\n  align-items: flex-start;\r\n  \r\n  flex-wrap: wrap;\r\n  \r\n  @media (max-width: ${props => (props.theme.media.mid_big -1) }px ) {\r\n    overflow-y: auto;\r\n    height: 360px;\r\n  }\r\n`\r\n\r\n// each TableTeam\r\nconst DivTableTeam = styled(Div)`\r\n  \r\n  width: 220px;\r\n  margin:5px;\r\n  \r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n`\r\n\r\nconst DivNameEachTeam = styled(Div)`\r\n  font-size: 1.2rem;\r\n`\r\n\r\nconst DivRosterEachTeam = styled(Div)`\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n`\r\n\r\nconst DivAverageMmrEachTeam = styled(Div)`\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: center;\r\n  align-items: center;\r\n`\r\nconst DivAverageMmrEachTeamText = styled(Div)`\r\n  width: 100px;\r\n  font-size: 0.9rem;\r\n  color: ${props => (props.theme.color_weak) };\r\n`\r\nconst DivAverageMmrEachTeamValue = styled(Div)`\r\n  width: 60px;\r\n`\r\n\r\n\r\n\r\n// each row\r\nconst DivRowPlayer = styled(Div)`\r\n  display: grid;\r\n  grid-template-columns:   100px 120px;\r\n  grid-template-rows: 40px;\r\n\r\n  \r\n  \r\n  border-bottom: 1px solid ${props => props.theme.color_very_weak};\r\n  &:last-child {\r\n    border-bottom-style: none;\r\n  }\r\n`\r\n\r\nconst DivBattletagHeader = styled(Div)`\r\n  padding-left: 10px;\r\n  \r\n  display: block;\r\n  text-algin: left;\r\n`\r\n\r\nconst DivBattletag = styled(Div)`\r\n  justify-self: start;\r\n  \r\n  padding-left: 10px;\r\n  \r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: flex-start;\r\n  align-items: flex-end;\r\n  \r\n  cursor: pointer;\r\n  \r\n  @media (max-width: ${props => (props.theme.media.small_mid -1) }px ) {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: flex-start;\r\n  }\r\n`\r\n\r\nconst DivBattletagName = styled(Div)`\r\n  \r\n  font-weight: ${props => props.isLeader ? \"bold\" : \"regular\"};\r\n  \r\n  width: auto;\r\n  max-width: inherit;\r\n  \r\n  display: inline;\r\n  text-algin: left;\r\n  overflow: hidden;\r\n  white-space: nowrap;\r\n  text-overflow: ellipsis;\r\n`\r\n\r\nconst DivRoles = styled(Div)`\r\n  \r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  \r\n  & > div {\r\n    width: auto;   // important!!!\r\n    height: auto;\r\n  }\r\n  \r\n  & > div > div {\r\n    width: 20px;\r\n    height: 20px;\r\n    margin: 2px;\r\n  }\r\n`\r\n\r\n\r\nconst RowPlayer = ({\r\n   battletag, roles, isLeader\r\n  , addRemoveNotification\r\n}) => {\r\n  \r\n  const regexBattletag = /(#\\d*)$/;\r\n  const listNumberBattletag = battletag.match(regexBattletag);\r\n  \r\n  const battletagNumber = listNumberBattletag[0];\r\n  const battletagName = battletag.replace(regexBattletag, \"\")\r\n  \r\n\r\n  return (\r\n    \r\n    <DivRowPlayer >\r\n      \r\n      <CopyToClipboard \r\n        text={battletag}\r\n        onCopy={ () => { addRemoveNotification(\"success\", `'${battletag}' has been copied`) } } >\r\n        \r\n        <DivBattletag> \r\n          <DivBattletagName isLeader={isLeader}> {battletagName} </DivBattletagName>\r\n        </DivBattletag>\r\n        \r\n      </CopyToClipboard>\r\n      \r\n      <DivRoles> \r\n        <Div> {(roles.includes(\"Tank\"))? <IconTank width={\"20px\"} height={\"20px\"} /> : <Div></Div>} </Div>\r\n        <Div> {(roles.includes(\"Bruiser\"))? <IconBruiser width={\"20px\"} height={\"20px\"} /> : <Div></Div>} </Div>\r\n        <Div> {(roles.includes(\"Melee Assassin\"))? <IconMeleeAssassin width={\"18px\"} height={\"20px\"} /> : <Div></Div>} </Div>\r\n        <Div> {(roles.includes(\"Ranged Assassin\"))? <IconRangedAssassin width={\"20px\"} height={\"20px\"} /> : <Div></Div>} </Div>\r\n        <Div> {(roles.includes(\"Healer\"))? <IconHealer width={\"15px\"} height={\"20px\"} /> : <Div></Div>} </Div>\r\n      </DivRoles>\r\n         \r\n    </DivRowPlayer>\r\n  )\r\n}\r\n\r\n\r\n\r\nconst TableTeam = ({objTeam, listPlayerEntry, addRemoveNotification, region}) => {\r\n  \r\n  const listPlayerBattletag = objTeam.listPlayerBattletag;\r\n  \r\n  //  정렬 함수\r\n  const sortListBattletagByMmrHigherFirst = (battletag1, battletag2) => {    // mmr 높은순으로 list of battletags\r\n    \r\n    const objPlayer1 = listPlayerEntry.find(objPlayer => objPlayer._id === battletag1)\r\n    const objPlayer2 = listPlayerEntry.find(objPlayer => objPlayer._id === battletag2)\r\n    \r\n    if (objPlayer1.tags.includes(\"leader\")) { return (-1) }// leader 는 무조건 앞에\r\n    else if (objPlayer2.tags.includes(\"leader\")) { return (1) }// leader 는 무조건 앞에\r\n    else {\r\n      return (objPlayer2.mmr.standard[region] - objPlayer1.mmr.standard[region]);\r\n    // ex 3333, 222, 1111\r\n    }\r\n  }\r\n  \r\n  // 평균 mmr 계산\r\n  let sumOfMmmr = 0;\r\n  for (let iMember=0; iMember < 5; iMember++) {\r\n    const cBattletag = listPlayerBattletag[iMember];\r\n    const cObjPlayer = listPlayerEntry.find(objPlayer => objPlayer._id === cBattletag);\r\n    sumOfMmmr += cObjPlayer.mmr.standard[region];\r\n  }\r\n  const averageOfMmr = Math.floor(sumOfMmmr/5);\r\n  \r\n  \r\n  const listPlayerBattletagSorted = listPlayerBattletag.sort( (battletag1, battletag2)=> sortListBattletagByMmrHigherFirst (battletag1, battletag2));\r\n  \r\n  return (\r\n    \r\n    <DivTableTeam>\r\n      \r\n      <DivNameEachTeam> {objTeam.name} </DivNameEachTeam>\r\n      \r\n      <DivRosterEachTeam>\r\n        {listPlayerBattletagSorted.map( (battletag, i) => {\r\n         \r\n         const cObjPlayer = listPlayerEntry.find(objPlayer => objPlayer._id === battletag);\r\n         const isLeader = cObjPlayer.tags.includes(\"leader\");\r\n         \r\n         return(\r\n            <RowPlayer \r\n              key={battletag}\r\n              battletag={battletag}\r\n              roles={cObjPlayer.roles}\r\n              isLeader={isLeader}\r\n              addRemoveNotification={addRemoveNotification} />\r\n           )\r\n          \r\n          \r\n        }) // inside map\r\n        }\r\n      </DivRosterEachTeam>\r\n      \r\n      <DivAverageMmrEachTeam> \r\n        <DivAverageMmrEachTeamText> average mmr: </DivAverageMmrEachTeamText>\r\n        <DivAverageMmrEachTeamValue> {averageOfMmr} </DivAverageMmrEachTeamValue>\r\n      </DivAverageMmrEachTeam>\r\n    \r\n  </DivTableTeam>\r\n  \r\n  ) // return\r\n}\r\n\r\n/* \r\n\r\n*/\r\n\r\n\r\nconst Result = ({\r\n  authority\r\n  ,idPlanTeam ,option, listPlayerEntry, listResult\r\n  , addRemoveNotification, addResult, deleteResult\r\n}) => {\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  const inputTitleResult = useInput(\"\");\r\n  \r\n  const [listTeamLocal, setListTeamLocal] = useState([]);\r\n  const [resultShowing, setResultShowing] = useState( {listTeam:[]} );\r\n  \r\n  const region = option.region;\r\n  const numberTeamsPlanned = option.numberTeams;\r\n  const listPlayerBattletag = (Object.keys(listPlayerEntry)).map(element=>listPlayerEntry[element]._id); // list of battletags, this can be modified by .sort\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  // 1. confirmed - 2. leader - 3. less roles player(2, 1) - 4. rest\r\n  const onClick_generateTeams = (event) => {\r\n    \r\n    let numberTeamsResult;\r\n    let listBattletagPlaying = [];\r\n    let listBattletagPlayingSorted = [];\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    //  많이 쓸 정렬 함수\r\n    const sortListBattletagByMmrHigherFirst = (battletag1, battletag2) => {    // mmr 높은순으로 list of battletags\r\n      \r\n      const objPlayer1 = listPlayerEntry.find(objPlayer => objPlayer._id === battletag1)\r\n      const objPlayer2 = listPlayerEntry.find(objPlayer => objPlayer._id === battletag2)\r\n      \r\n      return (objPlayer2.mmr.standard[region] - objPlayer1.mmr.standard[region]);\r\n      // ex 3333, 222, 1111\r\n    }\r\n    \r\n    \r\n    // A. 먼저 leader, confirmed  인 것들 고려해서 총 플레이 인원 뽑기\r\n    // B. 그다음 총 리스트를 leader, 플레이 역할 적은 플레이어, 그외 로 세 개로 나누고, 각각의 3개의 리스트 안에서 mmr 높은 순으로 정렬하고 합치기\r\n    // C. 정렬된 플레이러들을, (example of 3 teams)\r\n    // team:  0 1 2    2 1 0   0 1 2    2 1 0  마지막 주기는  mmr 총합 낮은 팀에 mmr 높은 사람 넣는 식으로!\r\n    \r\n    // A-1\r\n    const listBattletagConfirmed = listPlayerBattletag.filter(\r\n      battletag => {\r\n        const objPlayer = listPlayerEntry.find(objPlayer => objPlayer._id === battletag)\r\n        return ( objPlayer.status === \"confirmed\" )\r\n      }\r\n    )\r\n    \r\n    const listBattletagConfirmedLeader = listBattletagConfirmed.filter(\r\n      battletag => {\r\n        const objPlayer = listPlayerEntry.find(objPlayer => objPlayer._id === battletag)\r\n        return (objPlayer.tags.includes(\"leader\"))\r\n      }\r\n    )\r\n    \r\n    const listBattletagConfirmedNonLeader = listBattletagConfirmed.filter(\r\n      battletag => {\r\n        const objPlayer = listPlayerEntry.find(objPlayer => objPlayer._id === battletag)\r\n        return ( !(objPlayer.tags.includes(\"leader\")) )\r\n      }\r\n    )\r\n    \r\n    \r\n    //  먼저 설정된 팀 개수 검토\r\n    \r\n    // numberTeamsPlanned: 0  means auto \r\n    if ( numberTeamsPlanned === 0 ) {\r\n      numberTeamsResult = Math.floor(listBattletagConfirmed.length / 5);\r\n    }\r\n    else if (listBattletagConfirmed.length < (numberTeamsPlanned * 5)) {\r\n      addRemoveNotification(\"error\", \"the number of team which you have set was adjusted\");\r\n      numberTeamsResult = Math.floor(listBattletagConfirmed.length / 5);\r\n    }\r\n    else {numberTeamsResult = numberTeamsPlanned}\r\n    \r\n    \r\n    // A-2\r\n    if (numberTeamsResult === 0) {\r\n      addRemoveNotification(\"error\", \"need at least 5 confirmed players\");\r\n    }\r\n    else if (listBattletagConfirmedLeader.length >= numberTeamsResult * 5 ) {\r\n      listBattletagPlaying = getRandomSubArray(listBattletagConfirmedLeader, numberTeamsPlanned * 5 );\r\n    }\r\n    else {\r\n      const numberConfirmedLeader = listBattletagConfirmedLeader.length;\r\n      const listBattletagConfirmedNonLeaderPlaying = getRandomSubArray(listBattletagConfirmedNonLeader, (numberTeamsResult * 5 - numberConfirmedLeader) );\r\n      listBattletagPlaying = [...listBattletagConfirmedLeader, ...listBattletagConfirmedNonLeaderPlaying];\r\n    }\r\n    \r\n    \r\n    \r\n    //console.log(\"listBattletagPlaying\")\r\n    //console.log(listBattletagPlaying)\r\n    \r\n    // B. 그다음 총 리스트를 leader, 플레이 역할 적은 플레이어, 그외 로 세 개로 나누고, 각각의 3개의 리스트 안에서 mmr 높은 순으로 정렬하고 합치기\r\n    let listBattletagPlayingLeader = listBattletagPlaying.filter(\r\n      battletag => {\r\n        const objPlayer = listPlayerEntry.find(objPlayer => objPlayer._id === battletag)\r\n        return ( objPlayer.tags.includes(\"leader\") )\r\n      }\r\n    )\r\n    listBattletagPlayingLeader = listBattletagPlayingLeader.sort( (battletag1, battletag2) => sortListBattletagByMmrHigherFirst(battletag1, battletag2) );\r\n    \r\n    \r\n    let listBattletagPlayingLessRoles = listBattletagPlaying.filter(\r\n      battletag => {\r\n        const objPlayer = listPlayerEntry.find(objPlayer => objPlayer._id === battletag)\r\n        return ( !(objPlayer.tags.includes(\"leader\")) && objPlayer.roles.length <= 2 )\r\n      }\r\n    )\r\n    listBattletagPlayingLessRoles = listBattletagPlayingLessRoles.sort( (battletag1, battletag2) => sortListBattletagByMmrHigherFirst(battletag1, battletag2) );\r\n\r\n   \r\n   let listBattletagPlayingTheOthers = listBattletagPlaying.filter(\r\n      battletag => {\r\n        const objPlayer = listPlayerEntry.find(objPlayer => objPlayer._id === battletag)\r\n        return (  !(objPlayer.roles.length <= 2) && !(objPlayer.tags.includes(\"leader\"))   )\r\n      }\r\n    )\r\n    listBattletagPlayingTheOthers = listBattletagPlayingTheOthers.sort( (battletag1, battletag2) => sortListBattletagByMmrHigherFirst(battletag1, battletag2) );\r\n    \r\n    \r\n    // finally\r\n    listBattletagPlayingSorted = [...listBattletagPlayingLeader, ...listBattletagPlayingLessRoles, ...listBattletagPlayingTheOthers];\r\n    \r\n   console.log(`listBattletagPlayingSorted`) \r\n  console.log(listBattletagPlayingSorted) \r\n    \r\n    \r\n    \r\n   // C. 정렬된 플레이러들을, (example of 3 teams)\r\n   // team:  0 1 2    2 1 0   0 1 2    2 1 0  마지막 주기는  mmr 총합 낮은 팀에 mmr 높은 사람 넣는 식으로!\r\n   \r\n   \r\n   //https://stackoverflow.com/questions/3746725/how-to-create-an-array-containing-1-n\r\n   \r\n   \r\n    let listIndexTeam = [];\r\n   \r\n    const listIncreasing = Array.from(Array(numberTeamsResult), (_, i) => i)  // => [0, 1, 2, 3, 4, 5, ...]\r\n    const listDecreasing = Array.from(Array(numberTeamsResult), (_, i) => ( (numberTeamsResult - 1) - i) ) // => [5, 4, 3, ... ]\r\n\r\n    \r\n    listIndexTeam = [...listIncreasing, ...listDecreasing, ...listIncreasing, ...listDecreasing];\r\n    //console.log('listIndexTeam')\r\n    //console.log(listIndexTeam)\r\n    \r\n    \r\n    \r\n    let listTeamTemp = new Array(numberTeamsResult);\r\n    for ( let i  =0; i  < numberTeamsResult; i++) {\r\n      listTeamTemp[i] = {};\r\n      \r\n      listTeamTemp[i]['name'] = `TEAM ${i+1}`;\r\n      listTeamTemp[i]['listPlayerBattletag'] = [];\r\n    }\r\n    \r\n    \r\n    \r\n    for ( let iBattletag =0; iBattletag < (listBattletagPlayingSorted.length - numberTeamsResult) ; iBattletag++) {\r\n      \r\n      const cBattletag = listBattletagPlayingSorted[iBattletag];\r\n      const indexTeamToPush = listIndexTeam[iBattletag];\r\n      \r\n      listTeamTemp[ indexTeamToPush ]['listPlayerBattletag'].push( cBattletag );\r\n    }\r\n    \r\n    console.log(\"listTeamTemp\")\r\n    console.log(listTeamTemp)\r\n    \r\n    \r\n    let listTeamSumOfMmr =  Array.from(Array(numberTeamsResult), (_, i) => 0);  // numberTeamsResult 개의  0 으로 이루어진 리스트\r\n    let listTeamAverageOfMmr =  Array.from(Array(numberTeamsResult), (_, i) => 0);  // numberTeamsResult 개의  0 으로 이루어진 리스트\r\n    //console.log(listTeamSumOfMmr);\r\n    \r\n    for ( let iTeam =0; iTeam < numberTeamsResult; iTeam++) {\r\n      \r\n      for ( let iMember =0; iMember < 4; iMember++) {\r\n        \r\n        const cBattletag = listTeamTemp[iTeam]['listPlayerBattletag'][iMember];\r\n        const cObjPlayer = listPlayerEntry.find(objPlayer => objPlayer._id === cBattletag);\r\n        \r\n        listTeamSumOfMmr[iTeam] += cObjPlayer.mmr.standard[region];\r\n      }\r\n      \r\n    }\r\n    \r\n    console.log(\"listTeamSumOfMmr\")\r\n    console.log(listTeamSumOfMmr)\r\n    \r\n    let listIndexTeamWhichNeedHighMmrPlayer = [];\r\n    const listTool = Array.from(Array(numberTeamsResult), (_, i) => i); // [0, 1, 2, ...]\r\n    listIndexTeamWhichNeedHighMmrPlayer = listTool.sort( (index1, index2) => {\r\n      \r\n      const SumOfMmmr1 = listTeamSumOfMmr[index1];\r\n      const SumOfMmmr2 = listTeamSumOfMmr[index2];\r\n      \r\n      return (SumOfMmmr1 - SumOfMmmr2);  // 작은게 앞에 나오게 된다.\r\n    } )\r\n    \r\n    \r\n    // 마지막 인원들 넣기\r\n    for ( let jTeam =0; jTeam < numberTeamsResult; jTeam++) {\r\n      \r\n      const cIndexTeam = listIndexTeamWhichNeedHighMmrPlayer[jTeam];\r\n      const cBattletag = listBattletagPlayingSorted[numberTeamsResult * 4 + jTeam];\r\n      const cObjPlayer = listPlayerEntry.find(objPlayer => objPlayer._id === cBattletag);\r\n\r\n      (listTeamTemp[cIndexTeam]['listPlayerBattletag']).push(cBattletag);\r\n      \r\n      listTeamSumOfMmr[cIndexTeam] += cObjPlayer.mmr.standard[region];\r\n    }\r\n    \r\n    // calculate mmr average\r\n    for ( let iTeam =0; iTeam < numberTeamsResult; iTeam++) {\r\n      \r\n      listTeamAverageOfMmr[iTeam] = listTeamSumOfMmr[iTeam] / 5\r\n      \r\n    }\r\n    \r\n    console.log(listTeamTemp);\r\n    \r\n    console.log(\"final average of mmr each team: \")\r\n    console.log(listTeamAverageOfMmr)\r\n\r\n    setListTeamLocal(listTeamTemp);\r\n    \r\n    const newResult = {\r\n      title: \"local\"\r\n      , _id: \"local\"\r\n      , added: Date.now()\r\n      , listTeam: listTeamTemp\r\n    }\r\n    \r\n    \r\n    // 이미 list에 있는 _id = \"local\" 인걸 없애야 한다\r\n    addResult(newResult);\r\n    \r\n    //  표시\r\n    setResultShowing(newResult);\r\n  } //onClick_generateTeams\r\n  \r\n  \r\n/*\r\nconst inputTitleResult = useInput(\"\");\r\n\r\nconst [listTeams, setListTeams] = useState([]);\r\n\r\nconst region = option.region;\r\nconst numberTeamsPlanned = option.numberTeams;\r\nconst listPlayerBattletag = (Object.keys(listPlayerEntry)).map(element=>listPlayerEntry[element]._id); // list of battletags, this can be modified by .sort\r\n\r\n*/\r\n\r\n// 1\r\n  const onClick_SaveResult = async (event) => {\r\n    \r\n    if(listTeamLocal.length>0) {\r\n      try {\r\n        \r\n        let titleResult;\r\n        if (inputTitleResult.value) {titleResult = inputTitleResult.value}\r\n        else {\r\n          const now = new Date();\r\n          const date = now.getDate();\r\n          const hour = now.getHours();\r\n          const min = now.getMinutes();\r\n          \r\n          titleResult = `${date}_${hour}:${min}`;\r\n        }\r\n        \r\n        const newResult = {\r\n          title: titleResult\r\n          , _id: Date.now().toString()\r\n          , added: Date.now()\r\n          , listTeam: listTeamLocal\r\n        }\r\n        \r\n        addResult(newResult);\r\n        //replaceRegion(newRegion);\r\n        await axios.put (`${process.env.REACT_APP_URL_AHR}/plan-team/`,\r\n          {\r\n            filter: {_id: idPlanTeam}\r\n            , update : {\r\n              $push: { \"listResult\": newResult }\r\n            }\r\n          }\r\n        );\r\n        \r\n        addRemoveNotification(\"success\", \"result has been saved!\");\r\n      }\r\n      catch(error) {\r\n        addRemoveNotification(\"error\", \"failed in saving result\");\r\n      }\r\n    }\r\n    else {\r\n      addRemoveNotification(\"error\", \"there is no result yet\");\r\n    }\r\n    \r\n  }\r\n  \r\n  \r\n  const onClick_DeleteResult = async (event) => {\r\n    \r\n    if (resultShowing._id && resultShowing._id === \"local\") {\r\n      addRemoveNotification(\"error\", \"just generate another result\");\r\n    }\r\n    else if (resultShowing.listTeam.length) { // 표시중인 result 가 있어야 진행\r\n      try {\r\n        deleteResult(resultShowing._id);\r\n        //replaceRegion(newRegion);\r\n        await axios.put (`${process.env.REACT_APP_URL_AHR}/plan-team/`,\r\n          {\r\n            filter: {_id: idPlanTeam}\r\n            , update : {\r\n              $pull: { \"listResult\": { \"_id\": resultShowing._id } }\r\n            }\r\n          }\r\n        );\r\n  \r\n        \r\n        addRemoveNotification(\"success\", \"result has been deleted!\");\r\n      }\r\n      catch(error) {\r\n        addRemoveNotification(\"error\", \"failed in deleting result\");\r\n      }\r\n    }\r\n    else {\r\n      addRemoveNotification(\"error\", \"plese click result first\");\r\n    }\r\n    \r\n  }\r\n  \r\n  \r\n  \r\n  const onClick_ChooseResult = (event, idChosen) => {\r\n    \r\n    const resultChosen = listResult.find(element => element._id === idChosen)\r\n    setResultShowing(resultChosen);\r\n    console.log(resultChosen);\r\n  }\r\n  \r\n  \r\n  \r\n  return (\r\n  \r\n  <DivResult>\r\n    \r\n    <DivResultTitle> Result </DivResultTitle>\r\n    \r\n    {(authority===\"administrator\")?\r\n      <GroupButtonMain>\r\n        \r\n        <Div>\r\n          <ButtonGenerate onClick={onClick_generateTeams}>\r\n            <Div> Generate Teams </Div>\r\n            <IconMagic width={\"28px\"} height={\"28px\"} />   \r\n          </ButtonGenerate>\r\n        </Div>\r\n        \r\n        <Div>\r\n          <InputTitleResult {...inputTitleResult} placeholder=\"title of result\" />\r\n          \r\n          <ButtonSave onClick={onClick_SaveResult}>\r\n            <Div> Save </Div>\r\n            <IconUpload width={\"40px\"} height={\"32px\"} /> \r\n          </ButtonSave>\r\n          \r\n          <ButtonDelete onClick={onClick_DeleteResult} >\r\n            <Div> Delete </Div>\r\n            <IconDelete width={\"28px\"} height={\"32px\"} /> \r\n          </ButtonDelete>\r\n          \r\n        </Div>\r\n      \r\n      </GroupButtonMain>\r\n      : <Div> </Div>\r\n    }\r\n    \r\n    \r\n    <ListTitleResult >\r\n    \r\n      {listResult.map(element=>\r\n        <ButtonChooseResult \r\n          isActive = {element._id === resultShowing._id}\r\n          key={element._id}\r\n          onClick={(event)=>onClick_ChooseResult(event, element._id)}\r\n          > {element.title} </ButtonChooseResult>\r\n      )}\r\n      \r\n    </ListTitleResult>\r\n    \r\n  \r\n    <DivAllTeams>\r\n     {(resultShowing.listTeam.length)?\r\n      \r\n      resultShowing.listTeam.map( (team, index)=>\r\n        < TableTeam \r\n          key = {team.name}\r\n          objTeam = {team}\r\n          listPlayerEntry ={listPlayerEntry}\r\n          addRemoveNotification = {addRemoveNotification}\r\n          region = {region}\r\n        /> \r\n      )\r\n     \r\n     : \"choose or generate result\"}\r\n    \r\n    </DivAllTeams>\r\n    \r\n  </DivResult>\r\n    \r\n  )\r\n}\r\n\r\n\r\n\r\n\r\nfunction mapStateToProps(state) { \r\n  return { \r\n    authority: state.authority\r\n    ,idPlanTeam: state.planTeam._id\r\n    ,option: state.planTeam.option\r\n    ,listPlayerEntry: state.planTeam.listPlayerEntry\r\n    ,listResult: state.planTeam.listResult\r\n    //listPlayerEntry: [...state.planTeam.listPlayerEntry]\r\n    //,workingAddPlayerToListPlayerEntry: state.working.addPlayerToListPlayerEntry\r\n    //,readyPlanTeam: state.ready.planTeam\r\n    //,loading: state.loading\r\n  }; \r\n} \r\n\r\nfunction mapDispatchToProps(dispatch) { \r\n  return { \r\n    addResult: (resultTeam) => dispatch( addResult(resultTeam) ) \r\n    , deleteResult: (idResult) => dispatch( deleteResult(idResult) )\r\n    ,  addRemoveNotification: (situation, message, time) => dispatch( addRemoveNotification(situation, message, time) )\r\n  }; \r\n}\r\n\r\n\r\n// TableEntry 컴포넌트에서 redux의 state, dispatch 를 일부분 골라서 이용가능하게 된다\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Result);"]},"metadata":{},"sourceType":"module"}